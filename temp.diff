diff --git a/.gitignore b/.gitignore
index e14f498..0feb66b 100644
--- a/.gitignore
+++ b/.gitignore
@@ -55,3 +55,4 @@ Thumbs.db
 *.swp
 desktop.ini
 tags
+AGENTS.md
diff --git a/test.cpp b/test.cpp
index 3e95fba..c932a78 100644
--- a/test.cpp
+++ b/test.cpp
@@ -667,8 +667,8 @@ UTEST( Buffer, UpdateFunctionality )
     // Basic Update
     vhUpdateVertexBuffer( buf, vhAllocMem( 256 ), 0 );
     
-    // Offset Update
-    vhUpdateVertexBuffer( buf, vhAllocMem( 100 ), 512 );
+    // Offset Update (512 bytes = ~42.67 vertices, round to 43 vertices for stride 12)
+    vhUpdateVertexBuffer( buf, vhAllocMem( 100 ), 43 );
     
     vhFlush();
 
diff --git a/vrhi.h b/vrhi.h
index 3001549..e1e9fd7 100644
--- a/vrhi.h
+++ b/vrhi.h
@@ -330,13 +330,13 @@ void vhCreateVertexBuffer(
 //
 // |buffer| is the handle to the buffer to update.
 // |data| is the source data. Takes ownership of the memory.
-// |offset| is the byte offset within the buffer to start writing.
+// |offsetVerts| is the vertex offset within the buffer to start writing (in vertices, not bytes).
 // |numVerts| is the number of vertices in the buffer. It is ignored if |data| is not null.
 // VIDL_GENERATE
 void vhUpdateVertexBuffer(
     vhBuffer buffer,
     const vhMem* data,
-    uint64_t offset = 0,
+    uint64_t offsetVerts = 0,
     uint64_t numVerts = 0
 );
 
diff --git a/vrhi_generated.h b/vrhi_generated.h
index 28c3776..98603f5 100644
--- a/vrhi_generated.h
+++ b/vrhi_generated.h
@@ -131,13 +131,13 @@ struct VIDL_vhUpdateVertexBuffer
     uint64_t MAGIC = kMagic;
     vhBuffer buffer;
     const vhMem* data;
-    uint64_t offset = 0;
+    uint64_t offsetVerts = 0;
     uint64_t numVerts = 0;
 
     VIDL_vhUpdateVertexBuffer() = default;
 
-    VIDL_vhUpdateVertexBuffer(vhBuffer _buffer, const vhMem* _data, uint64_t _offset, uint64_t _numVerts)
-        : buffer(_buffer), data(_data), offset(_offset), numVerts(_numVerts) {}
+    VIDL_vhUpdateVertexBuffer(vhBuffer _buffer, const vhMem* _data, uint64_t _offsetVerts, uint64_t _numVerts)
+        : buffer(_buffer), data(_data), offsetVerts(_offsetVerts), numVerts(_numVerts) {}
 };
 
 struct VIDL_vhCreateIndexBuffer
@@ -162,13 +162,13 @@ struct VIDL_vhUpdateIndexBuffer
     uint64_t MAGIC = kMagic;
     vhBuffer buffer;
     const vhMem* data;
-    uint64_t offset = 0;
+    uint64_t offsetIndices = 0;
     uint64_t numIndices = 0;
 
     VIDL_vhUpdateIndexBuffer() = default;
 
-    VIDL_vhUpdateIndexBuffer(vhBuffer _buffer, const vhMem* _data, uint64_t _offset, uint64_t _numIndices)
-        : buffer(_buffer), data(_data), offset(_offset), numIndices(_numIndices) {}
+    VIDL_vhUpdateIndexBuffer(vhBuffer _buffer, const vhMem* _data, uint64_t _offsetIndices, uint64_t _numIndices)
+        : buffer(_buffer), data(_data), offsetIndices(_offsetIndices), numIndices(_numIndices) {}
 };
 
 struct VIDL_vhDestroyBuffer
diff --git a/vrhi_impl_backend.h b/vrhi_impl_backend.h
index 2212737..7faf80f 100644
--- a/vrhi_impl_backend.h
+++ b/vrhi_impl_backend.h
@@ -631,7 +631,7 @@ public:
         backendBuffers[ buffer ] = std::move( bbuf );
     }
 
-    void Handle_vhUpdateBufferCommon_Internal( const char* fn, vhBuffer buffer, uint64_t offset, const vhMem* data, uint64_t count )
+    void Handle_vhUpdateBufferCommon_Internal( const char* fn, vhBuffer buffer, uint64_t offsetElements, const vhMem* data, uint64_t count, bool isVertexBuffer )
     {
         if ( buffer == VRHI_INVALID_HANDLE ) return;
 
@@ -642,21 +642,34 @@ public:
         }
         auto& bbuf = backendBuffers[ buffer ];
 
+        // Convert element offset to byte offset
+        uint64_t byteOffset = 0;
+        if ( isVertexBuffer )
+        {
+            byteOffset = offsetElements * bbuf->stride;
+        }
+        else
+        {
+            // Index buffer - determine index size from flags
+            uint64_t indexSize = (bbuf->flags & VRHI_BUFFER_INDEX32) ? sizeof(uint32_t) : sizeof(uint16_t);
+            byteOffset = offsetElements * indexSize;
+        }
+
         if ( data )
         {
-            if ( offset + data->size() > bbuf->desc.byteSize && !( bbuf->flags & VRHI_BUFFER_ALLOW_RESIZE ) )
+            if ( byteOffset + data->size() > bbuf->desc.byteSize && !( bbuf->flags & VRHI_BUFFER_ALLOW_RESIZE ) )
             {
-                VRHI_ERR( "%s() : Update range [%llu, %llu] exceeds bhandle size %llu!\n", 
-                    fn, offset, offset + data->size(), bbuf->desc.byteSize );
+                VRHI_ERR( "%s() : Update range [%llu, %llu] exceeds buffer size %llu!\n", 
+                    fn, byteOffset, byteOffset + data->size(), bbuf->desc.byteSize );
                 return;
             }
-            BE_UpdateBuffer( *bbuf, offset, data );
+            BE_UpdateBuffer( *bbuf, byteOffset, data );
         }
         else if ( count > 0 )
         {
             if ( !( bbuf->flags & VRHI_BUFFER_ALLOW_RESIZE ) )
             {
-                VRHI_ERR( "%s() : resize requested but bhandle does not have ALLOW_RESIZE flag!\n", fn );
+                VRHI_ERR( "%s() : resize requested but buffer does not have ALLOW_RESIZE flag!\n", fn );
                 return;
             }
             BE_ResizeBuffer( *bbuf, count * bbuf->stride );
@@ -703,7 +716,8 @@ public:
     {
         BE_CmdRAII cmdRAII( cmd );
         auto dataRAII = BE_MemRAII( cmd->data );
-        Handle_vhUpdateBufferCommon_Internal( "vhUpdateVertexBuffer", cmd->buffer, cmd->offset, cmd->data, cmd->numVerts );
+        
+        Handle_vhUpdateBufferCommon_Internal( "vhUpdateVertexBuffer", cmd->buffer, cmd->offsetVerts, cmd->data, cmd->numVerts, true );
     }
 
     void Handle_vhCreateIndexBuffer( VIDL_vhCreateIndexBuffer* cmd ) override
@@ -730,7 +744,8 @@ public:
     {
         BE_CmdRAII cmdRAII( cmd );
         auto dataRAII = BE_MemRAII( cmd->data );
-        Handle_vhUpdateBufferCommon_Internal( "vhUpdateIndexBuffer", cmd->buffer, cmd->offset, cmd->data, cmd->numIndices );
+        
+        Handle_vhUpdateBufferCommon_Internal( "vhUpdateIndexBuffer", cmd->buffer, cmd->offsetIndices, cmd->data, cmd->numIndices, false );
     }
 
     void Handle_vhDestroyBuffer( VIDL_vhDestroyBuffer* cmd ) override
